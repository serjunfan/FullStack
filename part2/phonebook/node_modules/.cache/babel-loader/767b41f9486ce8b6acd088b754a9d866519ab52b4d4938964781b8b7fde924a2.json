{"ast":null,"code":"import _objectSpread from\"/home/luinpin/fullstack/part2/phonebook/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"/home/luinpin/fullstack/part2/phonebook/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useEffect}from'react';import Persons from'./components/Persons';import PersonForm from'./components/PersonForm';import Filter from'./components/Filter';import Notification from'./components/Notification';import personService from'./services/persons';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var App=function App(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),persons=_useState2[0],setPersons=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),newName=_useState4[0],setNewName=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),newNumber=_useState6[0],setNewNumber=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),filter=_useState8[0],setFilter=_useState8[1];var _useState9=useState({message:null}),_useState10=_slicedToArray(_useState9,2),info=_useState10[0],setInfo=_useState10[1];useEffect(function(){personService.getAll().then(function(initialPersons){return setPersons(initialPersons);});},[]);var notifyWith=function notifyWith(message){var type=arguments.length>1&&arguments[1]!==undefined?arguments[1]:'info';setInfo({message:message,type:type});setTimeout(function(){setInfo({message:null});},3000);};var cleanForm=function cleanForm(){setNewName('');setNewNumber('');};var updatePerson=function updatePerson(person){var ok=window.confirm(\"\".concat(newName,\" is already added to phonebook, replace the number?\"));if(ok){personService.update(person.id,_objectSpread(_objectSpread({},person),{},{number:newNumber})).then(function(updatedPerson){setPersons(persons.map(function(p){return p.id!==person.id?p:updatedPerson;}));notifyWith(\"phon number of \".concat(person.name,\" updated!\"));}).catch(function(){notifyWith(\"\".concat(person.name,\" has already been removed\"),'error');setPersons(persons.filter(function(p){return p.id!==person.id;}));});cleanForm();}};var addPerson=function addPerson(event){event.preventDefault();var person=persons.find(function(p){return p.name===newName;});if(person){updatePerson(person);return;}personService.create({name:newName,number:newNumber}).then(function(createdPerson){setPersons(persons.concat(createdPerson));notifyWith(\"\".concat(createdPerson.name,\" added!\"));cleanForm();}).catch(function(error){notifyWith(\"\".concat(error.response.data.error));cleanForm();});};var removePerson=function removePerson(person){var ok=window.confirm(\"remove \".concat(person.name,\" from phonebook?\"));if(ok){personService.remove(person.id).then(function(){setPersons(persons.filter(function(p){return p.id!==person.id;}));notifyWith(\"number of \".concat(person.name,\" deleted!\"));});}};var byFilterField=function byFilterField(p){return p.name.toLowerCase().includes(filter.toLowerCase());};var personsToShow=filter?persons.filter(byFilterField):persons;return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Phonebook\"}),/*#__PURE__*/_jsx(Notification,{info:info}),/*#__PURE__*/_jsx(Filter,{filter:filter,setFilter:setFilter}),/*#__PURE__*/_jsx(\"h3\",{children:\"Add a new\"}),/*#__PURE__*/_jsx(PersonForm,{addPerson:addPerson,newName:newName,newNumber:newNumber,setNewName:setNewName,setNewNumber:setNewNumber}),/*#__PURE__*/_jsx(\"h3\",{children:\"Phone numbers\"}),/*#__PURE__*/_jsx(Persons,{persons:personsToShow,removePerson:removePerson})]});};export default App;","map":{"version":3,"names":["useState","useEffect","Persons","PersonForm","Filter","Notification","personService","App","persons","setPersons","newName","setNewName","newNumber","setNewNumber","filter","setFilter","message","info","setInfo","getAll","then","initialPersons","notifyWith","type","setTimeout","cleanForm","updatePerson","person","ok","window","confirm","update","id","number","updatedPerson","map","p","name","catch","addPerson","event","preventDefault","find","create","createdPerson","concat","error","response","data","removePerson","remove","byFilterField","toLowerCase","includes","personsToShow"],"sources":["/home/luinpin/fullstack/part2/phonebook/src/App.js"],"sourcesContent":["import { useState, useEffect } from 'react'\n\nimport Persons from './components/Persons'\nimport PersonForm from './components/PersonForm'\nimport Filter from './components/Filter'\nimport Notification from './components/Notification'\n\nimport personService from './services/persons'\n\nconst App = () => {\n  const [persons, setPersons] = useState([]) \n  const [newName, setNewName] = useState('')\n  const [newNumber, setNewNumber] = useState('')\n  const [filter, setFilter] = useState('')\n  const [info, setInfo] = useState({ message: null})\n\n  useEffect(() => {\n    personService.getAll().then((initialPersons => \n      setPersons(initialPersons)\n    ))\n  }, [])\n\n  const notifyWith = (message, type='info') => {\n    setInfo({\n      message, type\n    })\n\n    setTimeout(() => {\n      setInfo({ message: null} )\n    }, 3000)\n  }\n\n  const cleanForm = () => {\n    setNewName('')\n    setNewNumber('') \n  }\n\n  const updatePerson = (person) => {\n    const ok = window.confirm(`${newName} is already added to phonebook, replace the number?`)\n    if (ok) {\n      \n      personService.update(person.id, {...person, number: newNumber}).then((updatedPerson) => {\n        setPersons(persons.map(p => p.id !== person.id ? p :updatedPerson ))\n        notifyWith(`phon number of ${person.name} updated!`)\n      })\n      .catch(() => {\n        notifyWith(`${person.name} has already been removed`, 'error')\n        setPersons(persons.filter(p => p.id !== person.id))\n      })\n\n      cleanForm()\n    }\n  }\n\n  const addPerson = (event) => {\n    event.preventDefault()\n    const person = persons.find(p => p.name === newName)\n\n    if (person) {\n      updatePerson(person)\n      return\n    }\n\n    personService.create({\n      name: newName,\n      number: newNumber\n    }).then(createdPerson => {\n      setPersons(persons.concat(createdPerson))\n\n      notifyWith(`${createdPerson.name} added!`)\n\n      cleanForm()\n    })\n    .catch(error => {\n      notifyWith(`${error.response.data.error}`)\n      \n      cleanForm()\n    })\n  }\n\n  const removePerson = (person) => {\n    const ok = window.confirm(`remove ${person.name} from phonebook?`)\n    if ( ok ) {\n      personService.remove(person.id).then( () => {\n        setPersons(persons.filter(p => p.id !== person.id))\n        notifyWith(`number of ${person.name} deleted!`)\n      })\n    }\n  }\n\n  const byFilterField =\n    p => p.name.toLowerCase().includes(filter.toLowerCase())\n\n  const personsToShow = filter ? persons.filter(byFilterField) : persons\n\n  return (\n    <div>\n      <h2>Phonebook</h2>\n\n      <Notification info={info} />\n\n      <Filter filter={filter} setFilter={setFilter} />\n      \n      <h3>Add a new</h3>\n\n      <PersonForm \n        addPerson={addPerson}\n        newName={newName}\n        newNumber={newNumber}\n        setNewName={setNewName}\n        setNewNumber={setNewNumber}\n      />\n\n      <h3>Phone numbers</h3>\n\n      <Persons\n        persons={personsToShow}\n        removePerson={removePerson}\n      />\n    </div>\n  )\n\n}\n\nexport default App\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}